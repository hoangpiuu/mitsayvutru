<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Theo dõi đơn hàng • Mít Sấy Vũ Trụ</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="icon" href="images/logo.png">

  <style>
    .tab-btn{position:relative;}
    .tab-active{color:#7c3aed!important;}
    .tab-active::after{
      content:"";position:absolute;left:0;right:0;bottom:-1px;height:2px;
      background:#7c3aed;border-radius:2px;
    }
  </style>
</head>
<body class="bg-white text-gray-900">

  <header class="sticky top-0 bg-white border-b z-40">
    <div class="max-w-3xl mx-auto px-4 py-3">
      <div class="flex justify-between items-center">
        <a href="index.html" class="flex items-center gap-3">
          <img src="images/logo.png" alt="Logo" class="w-10 h-10 rounded-full">
          <span class="font-semibold text-lg">Mít Sấy Vũ Trụ</span>
        </a>
      </div>

      <div class="mt-3 flex gap-8 border-b" role="tablist">
        <a href="index.html#cart" role="tab"
           class="tab-btn text-gray-500 hover:text-gray-800 py-2">Giỏ hàng</a>
        <button role="tab"
           class="tab-btn tab-active text-purple-600 font-semibold py-2">Theo dõi đơn</button>
      </div>
    </div>
  </header>

  <main class="max-w-3xl mx-auto px-4 py-8">
    <div class="rounded-xl border p-4 sm:p-6">
      <h1 class="text-xl sm:text-2xl font-bold mb-4">Theo dõi đơn hàng</h1>
      <p class="text-gray-600 mb-6">Nhập <b>mã đơn hàng</b> hoặc <b>email</b> để xem trạng thái.</p>

      <form id="orderTrackForm" class="flex gap-2 mb-3">
        <input id="orderTrackInput" type="text"
               placeholder="VD: MSV12345 hoặc email@domain.com"
               class="flex-1 border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-400"
               required />
        <button type="submit"
                class="px-4 py-2 rounded-lg bg-purple-600 text-white hover:bg-purple-700">
          Xem
        </button>
      </form>

      <div id="orderTrackResult" class="hidden rounded-lg bg-gray-50 p-4 leading-7"></div>
      <p class="text-xs text-gray-500 mt-2">Mẹo: nếu quên mã đơn, hãy nhập email dùng khi đặt hàng.</p>
    </div>
  </main>

  <footer class="text-center text-xs text-gray-500 py-10">© 2025 Mít Sấy Vũ Trụ</footer>

  <script>
  const ORDER_STORE_KEY='msv_orders';
  function getOrders(){try{return JSON.parse(localStorage.getItem(ORDER_STORE_KEY))||[]}catch(e){return[]}}
  function saveOrders(l){localStorage.setItem(ORDER_STORE_KEY,JSON.stringify(l))}
  (function seedDemo(){
    const has=getOrders();if(has.length===0){
      saveOrders([
        {id:'MSV12345',email:'demo@mitsayvutru.space',status:'processing',ordered_at:'12/10/2025',tracking:''},
        {id:'MSV88888',email:'khach@example.com',status:'shipping',ordered_at:'10/10/2025',tracking:'#GHN-A1B2C3'},
        {id:'MSV77777',email:'user@domain.com',status:'delivered',ordered_at:'05/10/2025',tracking:'#VTP-778899'}
      ])
    }
  })();
  function toStatusText(s){const m={pending:'Đang xử lý',processing:'Đang xử lý',shipping:'Đang giao',delivered:'Hoàn tất'};return m[String(s||'').toLowerCase()]||s||'Đang xử lý'}
  function lookupOrder(q){const v=(q||'').trim().toLowerCase();if(!v)return null;return getOrders().find(o=>String(o.id||'').toLowerCase()===v||String(o.email||'').toLowerCase()===v)||null}
  (function init(){
    const f=document.getElementById('orderTrackForm'),i=document.getElementById('orderTrackInput'),b=document.getElementById('orderTrackResult');
    f.addEventListener('submit',e=>{
      e.preventDefault();const q=i.value.trim();const o=lookupOrder(q);
      if(!o){b.innerHTML=`<div class='bg-red-50 border border-red-300 text-red-700 p-3 rounded'>Không tìm thấy đơn hàng. Hãy kiểm tra mã đơn hoặc email.</div>`;}
      else{b.innerHTML=`<div><p><b>Tình trạng:</b> ${toStatusText(o.status)}</p><p><b>Ngày đặt:</b> ${o.ordered_at}</p><p><b>Mã vận đơn:</b> ${o.tracking||'-'}</p><p class='text-gray-500 mt-1 text-sm'>Đơn #${o.id} — ${o.email}</p></div>`;}
      b.classList.remove('hidden');
    });
    const usp=new URLSearchParams(location.search);const q=usp.get('q');if(q){i.value=q;f.dispatchEvent(new Event('submit'));}
  })();
  </script>
</body>
</html>
