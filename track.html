<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Theo d√µi ƒë∆°n h√†ng ‚Ä¢ M√≠t S·∫•y V≈© Tr·ª•</title>

  <!-- D√πng ƒë√∫ng phong c√°ch hi·ªán t·∫°i: Tailwind CDN (gi·ªëng index) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- favicon t√πy ch·ªçn -->
  <link rel="icon" href="images/favicon.png" />
  <meta name="theme-color" content="#000000" />
</head>
<body class="bg-white text-gray-900">
  <!-- Header g·ªçn: b·∫•m logo v·ªÅ trang ch·ªß -->
  <header class="sticky top-0 z-40 bg-black text-white">
    <div class="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
      <a href="index.html" class="flex items-center gap-3">
        <div class="w-10 h-10 rounded-full bg-black grid place-items-center overflow-hidden">
          <img data-brand-logo alt="Logo M√≠t S·∫•y V≈© Tr·ª•" class="w-full h-full object-contain" />
        </div>
        <span class="font-semibold">M√≠t S·∫•y V≈© Tr·ª•</span>
      </a>
      <nav class="hidden sm:flex items-center gap-6 text-sm">
        <a href="index.html" class="hover:text-yellow-400">Trang ch·ªß</a>
        <a href="products.html" class="hover:text-yellow-400">S·∫£n ph·∫©m</a>
        <span class="text-yellow-400">Theo d√µi ƒë∆°n</span>
        <a href="wholesale.html" class="hover:text-yellow-400">Li√™n h·ªá</a>
      </nav>
    </div>
  </header>

  <!-- N·ªôi dung ch√≠nh -->
  <main class="max-w-xl mx-auto px-4 py-10">
    <h1 class="text-2xl sm:text-3xl font-bold text-center mb-6">Theo d√µi ƒë∆°n h√†ng</h1>
    <p class="text-gray-600 text-center mb-8">
      Nh·∫≠p <b>m√£ ƒë∆°n h√†ng</b> ho·∫∑c <b>email</b> ƒë·ªÉ xem tr·∫°ng th√°i.
    </p>

    <form id="orderTrackForm" class="flex gap-2 mb-4">
      <input
        id="orderTrackInput"
        type="text"
        placeholder="VD: MSV12345 ho·∫∑c email@domain.com"
        class="flex-1 border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-yellow-400"
        aria-label="Nh·∫≠p m√£ ƒë∆°n h√†ng ho·∫∑c email"
        required
      />
      <button
        type="submit"
        class="px-4 py-2 rounded-lg bg-yellow-500 text-white hover:bg-yellow-600"
      >
        Xem
      </button>
    </form>

    <!-- K·∫øt qu·∫£ -->
    <div id="orderTrackResult" class="hidden rounded-lg bg-gray-50 p-4 leading-7"></div>

    <p class="text-xs text-gray-500 mt-3">
      M·∫πo: n·∫øu qu√™n m√£ ƒë∆°n, h√£y nh·∫≠p email d√πng khi ƒë·∫∑t h√†ng.
    </p>
  </main>

  <!-- Footer ng·∫Øn -->
  <footer class="text-center text-xs text-gray-500 py-8">
    ¬© 2025 M√≠t S·∫•y V≈© Tr·ª•
  </footer>

  <!-- Logo auto: ∆∞u ti√™n images/Logo.* -->
  <script>
  (function () {
    const candidates = [
      'images/Logo.png','images/Logo.jpg','images/Logo.jpeg',
      'images/logo.png','images/logo.jpg','images/logo.jpeg'
    ];
    async function pickLogo() {
      for (const p of candidates) {
        try { const r = await fetch(p, {method:'HEAD', cache:'no-store'}); if (r.ok) return p; } catch(e){}
      }
      return null;
    }
    document.addEventListener('DOMContentLoaded', async () => {
      const src = await pickLogo();
      document.querySelectorAll('img[data-brand-logo]').forEach(img => { if (src) img.src = src; });
    });
  })();
  </script>

  <!-- Logic theo d√µi ƒë∆°n: LocalStorage demo + d·ªÖ thay b·∫±ng API -->
  <script>
  const ORDER_STORE_KEY = 'msv_orders';

  function getOrders() {
    try { return JSON.parse(localStorage.getItem(ORDER_STORE_KEY)) || []; }
    catch(e){ return []; }
  }
  function saveOrders(list) { localStorage.setItem(ORDER_STORE_KEY, JSON.stringify(list)); }

  // DEMO seed ‚Äî c√≥ th·ªÉ x√≥a khi l√™n production
  (function seedDemo(){
    const has = getOrders();
    if (has.length === 0) {
      saveOrders([
        { id:'MSV12345', email:'demo@mitsayvutru.space', status:'processing', ordered_at:'12/10/2025', tracking:'' },
        { id:'MSV88888', email:'khach@example.com',       status:'shipping',   ordered_at:'10/10/2025', tracking:'#GHN-A1B2C3' },
        { id:'MSV77777', email:'user@domain.com',         status:'delivered',  ordered_at:'05/10/2025', tracking:'#VTP-778899' }
      ]);
    }
  })();

  function toStatusText(s){
    const map = { pending:'ƒêang x·ª≠ l√Ω', processing:'ƒêang x·ª≠ l√Ω', shipping:'ƒêang giao', delivered:'Ho√†n t·∫•t' };
    const key = String(s||'').toLowerCase();
    return map[key] || s || 'ƒêang x·ª≠ l√Ω';
  }

  function lookupOrder(q){
    const value = (q||'').trim().toLowerCase();
    if (!value) return null;
    const list = getOrders();
    return list.find(o =>
      String(o.id||'').toLowerCase() === value ||
      String(o.email||'').toLowerCase() === value
    ) || null;
  }

  (function initForm(){
    const form = document.getElementById('orderTrackForm');
    const input = document.getElementById('orderTrackInput');
    const box = document.getElementById('orderTrackResult');
    if (!form || !input || !box) return;

    // Prefill t·ª´ query ?q=
    const usp = new URLSearchParams(location.search);
    const q = usp.get('q') || '';
    if (q) input.value = q;

    function renderNotFound(q){
      box.innerHTML = `
        <div class="text-red-600">
          <p><b>Kh√¥ng t√¨m th·∫•y ƒë∆°n h√†ng.</b></p>
          <p>H√£y ki·ªÉm tra l·∫°i <i>m√£ ƒë∆°n</i> ho·∫∑c <i>email</i>: <span class="text-gray-700">${q}</span></p>
        </div>`;
      box.classList.remove('hidden');
    }

    function renderOrder(o){
      box.innerHTML = `
        <div class="text-gray-800">
          <p><b>T√¨nh tr·∫°ng:</b> ${toStatusText(o.status)}</p>
          <p><b>Ng√†y ƒë·∫∑t:</b> ${o.ordered_at || '-'}</p>
          <p><b>M√£ v·∫≠n ƒë∆°n:</b> ${o.tracking || '-'}</p>
          <p class="text-gray-500 mt-1">ƒê∆°n <b>#${o.id}</b> ‚Äî ${o.email || ''}</p>
        </div>`;
      box.classList.remove('hidden');
    }

    function submit(qv){
      const q = qv ?? input.value.trim();
      if (!q) return;
      const found = lookupOrder(q);
      if (!found) renderNotFound(q);
      else renderOrder(found);
    }

    form.addEventListener('submit', (e)=>{ e.preventDefault(); submit(); });

    // T·ª± tra n·∫øu c√≥ ?q=
    if (q) submit(q);
  })();

  // üîÑ G·ª£i √Ω: khi checkout xong, b·∫°n push ƒë∆°n m·ªõi v√†o LocalStorage:
  // const orders = getOrders();
  // orders.push({ id:'MSV2025-0001', email:'user@domain.com', status:'pending', ordered_at:new Date().toLocaleDateString('vi-VN'), tracking:'' });
  // saveOrders(orders);

  // üîå N·∫øu sau n√†y d√πng API/Google Sheet/Firebase:
  // - Thay lookupOrder(q) = fetch('/api/track?q='+encodeURIComponent(q)).then(r=>r.json())
  //   ƒë·ªÉ tr·∫£ v·ªÅ { id, email, status, ordered_at, tracking }
  </script>
</body>
</html>
